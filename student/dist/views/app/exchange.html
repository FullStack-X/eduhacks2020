<script type="text/html" template>
    <link rel="stylesheet" href="{{ layui.setter.base }}style/template.css?v={{ layui.admin.v }}-1" media="all">
</script>

<div class="layui-card layadmin-header">
    <div class="layui-breadcrumb" lay-filter="breadcrumb">
        <a lay-href="">主页</a>
        <a><cite>数字资源</cite></a>
        <a><cite>积分兑换</cite></a>
    </div>
</div>

<div class="layui-fluid layadmin-cmdlist-fluid">
    <div class="layui-row layui-col-space30">
        <div class="layui-col-md2 layui-col-sm4">
            <div class="cmdlist-container" id="exchange_container">
            </div>
        </div>
        <div class="layui-col-md12 layui-col-sm12">
            <div id="pager"></div>
        </div>
    </div>
</div>
<div id="exchangetpl">
    <a href="javascript:;">
        <img src="">
    </a>
    <a href="javascript:;">
        <div class="cmdlist-text">
            <p class="info"></p>
            <div class="price">
                <b class="integral"></b>
                <span class="flow">
                   <i class="layui-icon layui-icon-rate"></i>
                </span>
            </div>
        </div>
    </a>
</div>
<script>
    layui.use(['admin', 'laypage', 'layer', 'laytpl'], function () {
        var $ = layui.$
            , admin = layui.admin
            , laypage = layui.laypage
            , laytpl = layui.laytpl
            , layer = layui.layer;

        $.ajax({
            type: "get",
            url: "json/content/exchange.js",
            data: {},
            dataType: "json",
            success: function (res) {
                var json = eval(res);
                $.each(json.data, function (index, item) {
                    $("#exchange_container").append("<div id=\"course_mooc\">\n" +
                        "    <a href=\"javascript:;\">\n" +
                        "        <img style=\"height: 200px;\"\n" +
                        "             src=\"\" class=\"goodImg\">\n" +
                        "    </a>\n" +
                        "    <a href=\"javascript:;\">\n" +
                        "        <div class=\"cmdlist-text\">\n" +
                        "            <p class=\"info\"></p>\n" +
                        "            <div class=\"msg_detail\" style=\"padding-bottom: 5%\">\n" +
                        "                <b class=\"integral\" style=\"float: left;padding-top: 1px;margin-right: -10px\"></b>\n" +
                        "                <span class=\"flow\" style=\"float: right\">\n" +
                        "                    <i class=\"layui-icon layui-icon-rate\"></i>" +
                        "                </span>\n" +
                        "            </div>\n" +
                        "        </div>\n" +
                        "    </a>\n" +
                        "</div>");
                    var res = $('.goodImg').eq(index).attr('src', item.img);
                    console.log(res);
                    $('.info').eq(index).text(item.goodName);
                    $('.integral').eq(index).text(item.integral);
                    $('.flow').eq(index).append(item.exchanged);
                })
            },
            error: function () {
                layer.msg("错误")
            }
        });
        // $.get('http://47.92.50.43:8888/sys/jscount', data => {
        //     laypage.render({ //异步
        //         elem: 'pager',
        //         count: data.count, //数据总数，从服务端得到
        //         limit: 10,
        //         jump: function (obj) {
        //             // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        //             // console.log(obj.limit); //得到每页显示的条数
        //             $.get('http://htdocs.net/sys/jslist', {
        //                 pageIndex: obj.curr,
        //                 pageSize: obj.limit //给后台传参
        //             }, data => {
        //                 laytpl($("#exchangetpl").html()).render(data, function (html) {
        //                     $('#exchangecontainer').html(html);
        //                 });
        //             })
        //         }
        //     });
        // })
    });
</script>
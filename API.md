## API 文档
-   Webscoket
    -   [入门](#入门)
    -   [用户](#用户)
        -   [登录 Login](#登录)
-   HTTP

### 入门

在入门前, 需要先熟悉 websocket 的传参方式

**请求体 Request**

| 键名       | 值类型    | 说明                      |
| -------- | ------ | ----------------------- |
| type     | int    | [消息类型](#type)           |
| path     | string | [请求的路由信息](#path)        |
| location | string | [请求时当前页面的路由](#location) |
| data     | bytes  | [请求时传递的参数](#data)       |
| sign     | bytes  | [用于校验传递的参数完整性](#sign)   |

**响应体 Response**
| 键名 | 值类型 | 说明 |
| ---- | ---- | ---- |
| code | int | [状态码](#code-状态码)|
| msg | string | [消息](#msg)|
| type | int | [消息类型](#type-消息类型)|
| data | bytes | [回应的参数](#data-回应的参数)|
| render | bool | [是否渲染](#render)|
| html | object | [前端渲染代码](#html)|

#### 键说明

**请求体 Request**

##### `type`

-   **0** 为 系统消息
    -   此类型下吴强制字段要求
    -   此类型下可能传输心跳包

-   **1** 为 请求 (发起一个类似于 HTTP 的请求)
    -   此类型下必须包含 path

-   **2** 为 binary
    -   此类型下可能传送文件等
    -   此类型必须包含 `path` 用于鉴别文件
    -   此类型下必须包含 `sign` 用于检验消息的完整性

##### `path`

此字段仅在 `type` 为 1 时发送, 是目标所请求的路由信息

##### `location`

发起请求的页面的路径

##### `data`

此字段传输请求的数据, 类 HTTP Request Body, 在下面的一些API中, 例如登录, 将通过此字段传递登录的参数

##### `sign`

消息类型为 `1` 时计算方法为 **salt** + `data`

**\*salt** 一般包含在 `data` 中作为一个单独的键

##### `code` 状态码

此为状态码, 与 HTTP 状态码是一样的, 成功为 200

##### `msg`

对请求回应的消息, 如登录成功, 或登录失败

##### `type` 消息类型

-   **0** 为指令
    -   通常命令客户端, 如跳出验证码, 或强制断开客户端连接, 课堂签到
    -   在此类型下, 一般包含 `render` 用来渲染前端
-   **1** 为 `salt`
    -   服务端向客户端发送一个 `salt` 用于计算 `salt`
    -   通常会在客户端连接服务端时主动发送
    -   此消息类型时 `render` 不会存在消息
-   **2** 为 响应 (一个类似于 HTTP 的响应)
    -   此消息类型时 **不一定** 会包含 `render`
    -   此时 `data` 常为 `json` 类型, 通常用于 `table` 的数据渲染
-   **3** 为 响应 (一个类型于 HTTP 的响应, 且带前端渲染)
    -   此消息类型与 2 相似, 但一定包含了 `render` 来使前端渲染
-   **4** 为 binary
    -   此类型时, 可能是由服务器端主动向客户端发送文件

##### `data` 回应的参数

服务器返回的参数, 如登录会返回用户的信息, 就在此处

##### `render`

当此值为 `true` 时则代表需要渲染前端页面

##### `html`

当 `render` 为 `true` 时
`id`  为渲染部分的元素 ID
`iframe` 为是否为元素 ID 是否存在在 iframe 里
`code` 为 html 代码
`type` 为渲染位置

-   **0** 为 `body`
    -   渲染前端的 body 位置, 通常为页面渲染
-   **1** 为 `div`
    -   这个是渲染 `<div id="1"></div>` 的
    -   一般为消息框或者为弹出层

### 用户

该块包含了用户的登录 获取信息 ...

#### 登录

`data` 中的参数
| 键名 | 值类型 | 说明 |
| ---- | ---- |---- |
| user | string | 用户凭据 |
| password | string | 用户密码 |
| type | int | 登录类型 0为教务 1为教师 2为学生 |
| salt | bytes | 盐值 |
